<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web Content Extractor - CHIIP-SEEK</title>
    <style>
        :root {
            --primary-color: #2563eb;
            --secondary-color: #1e40af;
            --background-color: #0f172a;
            --surface-color: #1e293b;
            --text-color: #f8fafc;
            --border-color: #334155;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --error-color: #ef4444;
        }

        .light-mode {
            --background-color: #f8fafc;
            --surface-color: #ffffff;
            --text-color: #1e293b;
            --border-color: #cbd5e1;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
            transition: all 0.3s ease;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: var(--surface-color);
            border-radius: 12px;
            border: 1px solid var(--border-color);
        }

        .theme-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            color: var(--text-color);
            cursor: pointer;
            font-size: 1.5rem;
        }

        .input-section {
            background: var(--surface-color);
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 25px;
            border: 1px solid var(--border-color);
        }

        .url-input-container {
            display: flex;
            gap: 12px;
            margin-bottom: 15px;
        }

        .url-input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            background: var(--background-color);
            color: var(--text-color);
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .url-input:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .btn {
            padding: 12px 24px;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn:hover {
            background: var(--secondary-color);
            transform: translateY(-1px);
        }

        .btn:disabled {
            background: var(--border-color);
            cursor: not-allowed;
            transform: none;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .spinner {
            border: 3px solid var(--border-color);
            border-top: 3px solid var(--primary-color);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .tab {
            padding: 12px 20px;
            background: var(--surface-color);
            border: 1px solid var(--border-color);
            border-radius: 8px 8px 0 0;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .tab.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .tab-content {
            display: none;
            background: var(--surface-color);
            border: 1px solid var(--border-color);
            border-radius: 0 12px 12px 12px;
            padding: 25px;
            min-height: 400px;
        }

        .tab-content.active {
            display: block;
        }

        .content-area {
            white-space: pre-wrap;
            font-family: 'Courier New', monospace;
            line-height: 1.5;
            max-height: 600px;
            overflow-y: auto;
            padding: 15px;
            background: var(--background-color);
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: var(--background-color);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            text-align: center;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary-color);
        }

        .image-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
        }

        .image-item {
            background: var(--background-color);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            text-align: center;
        }

        .image-item img {
            max-width: 100%;
            height: auto;
            border-radius: 4px;
        }

        .link-list {
            max-height: 500px;
            overflow-y: auto;
        }

        .link-item {
            padding: 10px;
            border-bottom: 1px solid var(--border-color);
            word-break: break-all;
        }

        .link-item:last-child {
            border-bottom: none;
        }

        .history-section {
            margin-top: 25px;
        }

        .history-item {
            padding: 12px;
            margin-bottom: 8px;
            background: var(--surface-color);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .history-item:hover {
            border-color: var(--primary-color);
        }

        .tools {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .export-btn {
            background: var(--success-color);
        }

        .copy-btn {
            background: var(--warning-color);
        }

        .search-box {
            flex: 1;
            min-width: 200px;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            background: var(--success-color);
            color: white;
            border-radius: 8px;
            transform: translateX(400px);
            transition: transform 0.3s ease;
            z-index: 1000;
        }

        .notification.show {
            transform: translateX(0);
        }

        @media (max-width: 768px) {
            .url-input-container {
                flex-direction: column;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .tab {
                border-radius: 8px;
                margin-bottom: 5px;
            }
            
            .tab-content {
                border-radius: 8px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <button class="theme-toggle" id="themeToggle">üåô</button>
        
        <div class="header">
            <h1>üåê Web Content Extractor</h1>
            <p>–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏ –∞–Ω–∞–ª–∏–∑ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü</p>
        </div>

        <div class="input-section">
            <div class="url-input-container">
                <input type="url" class="url-input" id="urlInput" 
                       placeholder="https://example.com" required>
                <button class="btn" id="extractBtn">–ò–∑–≤–ª–µ—á—å –∫–æ–Ω—Ç–µ–Ω—Ç</button>
            </div>
            <div class="tools">
                <input type="text" class="url-input search-box" id="searchInput" 
                       placeholder="–ü–æ–∏—Å–∫ –ø–æ –∫–æ–Ω—Ç–µ–Ω—Ç—É...">
                <button class="btn copy-btn" id="copyBtn">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                <button class="btn export-btn" id="exportBtn">–≠–∫—Å–ø–æ—Ä—Ç</button>
            </div>
        </div>

        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞...</p>
        </div>

        <div class="tabs">
            <div class="tab active" data-tab="content">–û—Å–Ω–æ–≤–Ω–æ–π —Ç–µ–∫—Å—Ç</div>
            <div class="tab" data-tab="metadata">–ú–µ—Ç–∞-–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</div>
            <div class="tab" data-tab="images">–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</div>
            <div class="tab" data-tab="links">–°—Å—ã–ª–∫–∏</div>
            <div class="tab" data-tab="stats">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</div>
        </div>

        <div class="tab-content active" id="contentTab">
            <div class="content-area" id="contentArea"></div>
        </div>

        <div class="tab-content" id="metadataTab">
            <div class="content-area" id="metadataArea"></div>
        </div>

        <div class="tab-content" id="imagesTab">
            <div class="image-grid" id="imagesGrid"></div>
        </div>

        <div class="tab-content" id="linksTab">
            <div class="link-list" id="linksList"></div>
        </div>

        <div class="tab-content" id="statsTab">
            <div class="stats-grid" id="statsGrid"></div>
            <div class="content-area" id="detailedStats"></div>
        </div>

        <div class="history-section">
            <h3>–ò—Å—Ç–æ—Ä–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤</h3>
            <div id="historyList"></div>
        </div>
    </div>

    <div class="notification" id="notification"></div>

    <script>
        class WebContentExtractor {
            constructor() {
                this.currentData = null;
                this.history = JSON.parse(localStorage.getItem('extractionHistory')) || [];
                this.init();
            }

            init() {
                this.bindEvents();
                this.renderHistory();
                this.loadTheme();
            }

            bindEvents() {
                document.getElementById('extractBtn').addEventListener('click', () => this.extractContent());
                document.getElementById('urlInput').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') this.extractContent();
                });
                document.getElementById('copyBtn').addEventListener('click', () => this.copyContent());
                document.getElementById('exportBtn').addEventListener('click', () => this.exportContent());
                document.getElementById('searchInput').addEventListener('input', (e) => this.searchContent(e.target.value));
                document.getElementById('themeToggle').addEventListener('click', () => this.toggleTheme());

                // Tab switching
                document.querySelectorAll('.tab').forEach(tab => {
                    tab.addEventListener('click', () => this.switchTab(tab.dataset.tab));
                });
            }

            async extractContent() {
                const url = document.getElementById('urlInput').value.trim();
                
                if (!this.isValidUrl(url)) {
                    this.showNotification('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π URL', 'error');
                    return;
                }

                this.showLoading(true);
                
                try {
                    const content = await this.fetchContent(url);
                    this.currentData = this.parseContent(content, url);
                    this.renderContent();
                    this.addToHistory(url);
                    this.showNotification('–ö–æ–Ω—Ç–µ–Ω—Ç —É—Å–ø–µ—à–Ω–æ –∏–∑–≤–ª–µ—á–µ–Ω');
                } catch (error) {
                    this.showNotification('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞: ' + error.message, 'error');
                } finally {
                    this.showLoading(false);
                }
            }

            async fetchContent(url) {
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º CORS proxy –¥–ª—è –æ–±—Ö–æ–¥–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
                const proxyUrl = 'https://api.allorigins.win/get?url=';
                const response = await fetch(proxyUrl + encodeURIComponent(url));
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                return data.contents;
            }

            parseContent(html, url) {
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, 'text/html');
                
                // –û—Å–Ω–æ–≤–Ω–æ–π —Ç–µ–∫—Å—Ç (–æ—á–∏—â–µ–Ω–Ω—ã–π –æ—Ç –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –∏ —Ä–µ–∫–ª–∞–º—ã)
                const mainContent = this.extractMainText(doc);
                
                // –ú–µ—Ç–∞-–¥–∞–Ω–Ω—ã–µ
                const metadata = this.extractMetadata(doc);
                
                // –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
                const images = this.extractImages(doc, url);
                
                // –°—Å—ã–ª–∫–∏
                const links = this.extractLinks(doc, url);
                
                // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                const stats = this.calculateStats(mainContent, images, links);

                return {
                    url,
                    mainContent,
                    metadata,
                    images,
                    links,
                    stats,
                    timestamp: new Date().toISOString()
                };
            }

            extractMainText(doc) {
                // –£–¥–∞–ª—è–µ–º –Ω–µ–Ω—É–∂–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
                const unwantedSelectors = [
                    'nav', 'header', 'footer', 'aside', 'script', 'style',
                    '.nav', '.header', '.footer', '.sidebar', '.advertisement',
                    '.ad', '.banner', '.menu', '.navigation'
                ];
                
                unwantedSelectors.forEach(selector => {
                    doc.querySelectorAll(selector).forEach(el => el.remove());
                });

                // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—Å—Ç –∏–∑ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å–æ–¥–µ—Ä–∂–∞—Ç–µ–ª—å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
                const contentElements = doc.querySelectorAll('main, article, .content, .post, p, h1, h2, h3, h4, h5, h6');
                let text = '';
                
                contentElements.forEach(el => {
                    if (el.textContent.trim().length > 50) { // –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –¥–ª—è –∑–Ω–∞—á–∏–º–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
                        text += el.textContent.trim() + '\n\n';
                    }
                });

                return text || doc.body.textContent;
            }

            extractMetadata(doc) {
                const metadata = {};
                
                // –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–∞-—Ç–µ–≥–∏
                metadata.title = doc.querySelector('title')?.textContent || '';
                metadata.description = doc.querySelector('meta[name="description"]')?.getAttribute('content') || '';
                metadata.keywords = doc.querySelector('meta[name="keywords"]')?.getAttribute('content') || '';
                metadata.author = doc.querySelector('meta[name="author"]')?.getAttribute('content') || '';
                
                // Open Graph
                metadata.ogTitle = doc.querySelector('meta[property="og:title"]')?.getAttribute('content') || '';
                metadata.ogDescription = doc.querySelector('meta[property="og:description"]')?.getAttribute('content') || '';
                metadata.ogImage = doc.querySelector('meta[property="og:image"]')?.getAttribute('content') || '';
                
                // Twitter Card
                metadata.twitterTitle = doc.querySelector('meta[name="twitter:title"]')?.getAttribute('content') || '';
                metadata.twitterDescription = doc.querySelector('meta[name="twitter:description"]')?.getAttribute('content') || '';
                
                // –ó–∞–≥–æ–ª–æ–≤–∫–∏
                metadata.headings = {
                    h1: Array.from(doc.querySelectorAll('h1')).map(h => h.textContent.trim()),
                    h2: Array.from(doc.querySelectorAll('h2')).map(h => h.textContent.trim()),
                    h3: Array.from(doc.querySelectorAll('h3')).map(h => h.textContent.trim())
                };

                return metadata;
            }

            extractImages(doc, baseUrl) {
                const images = [];
                const imageElements = doc.querySelectorAll('img');
                
                imageElements.forEach(img => {
                    const src = img.src.startsWith('http') ? img.src : new URL(img.src, baseUrl).href;
                    images.push({
                        src: src,
                        alt: img.alt || '–ù–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è',
                        title: img.title || '',
                        width: img.width,
                        height: img.height
                    });
                });
                
                return images;
            }

            extractLinks(doc, baseUrl) {
                const links = [];
                const linkElements = doc.querySelectorAll('a[href]');
                
                linkElements.forEach(link => {
                    const href = link.href.startsWith('http') ? link.href : new URL(link.href, baseUrl).href;
                    links.push({
                        url: href,
                        text: link.textContent.trim() || '–ë–µ–∑ —Ç–µ–∫—Å—Ç–∞',
                        title: link.title || ''
                    });
                });
                
                return links;
            }

            calculateStats(content, images, links) {
                const words = content.trim() ? content.split(/\s+/).length : 0;
                const characters = content.length;
                const readingTime = Math.ceil(words / 200); // –°—Ä–µ–¥–Ω—è—è —Å–∫–æ—Ä–æ—Å—Ç—å —á—Ç–µ–Ω–∏—è 200 —Å–ª–æ–≤ –≤ –º–∏–Ω—É—Ç—É
                
                return {
                    words,
                    characters,
                    readingTime,
                    images: images.length,
                    links: links.length,
                    paragraphs: content.split('\n\n').filter(p => p.trim()).length
                };
            }

            renderContent() {
                if (!this.currentData) return;

                // –û—Å–Ω–æ–≤–Ω–æ–π —Ç–µ–∫—Å—Ç
                document.getElementById('contentArea').textContent = this.currentData.mainContent;

                // –ú–µ—Ç–∞-–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
                this.renderMetadata();

                // –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
                this.renderImages();

                // –°—Å—ã–ª–∫–∏
                this.renderLinks();

                // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                this.renderStats();
            }

            renderMetadata() {
                const metadata = this.currentData.metadata;
                let html = '';
                
                for (const [key, value] of Object.entries(metadata)) {
                    if (value && (typeof value !== 'object' || (Array.isArray(value) && value.length > 0))) {
                        html += `<strong>${key}:</strong> ${JSON.stringify(value, null, 2)}\n\n`;
                    }
                }
                
                document.getElementById('metadataArea').textContent = html;
            }

            renderImages() {
                const grid = document.getElementById('imagesGrid');
                grid.innerHTML = '';
                
                this.currentData.images.forEach(img => {
                    const imgElement = document.createElement('div');
                    imgElement.className = 'image-item';
                    imgElement.innerHTML = `
                        <img src="${img.src}" alt="${img.alt}" loading="lazy">
                        <p><strong>Alt:</strong> ${img.alt}</p>
                        ${img.title ? `<p><strong>Title:</strong> ${img.title}</p>` : ''}
                        ${img.width ? `<p><strong>–†–∞–∑–º–µ—Ä:</strong> ${img.width}x${img.height}</p>` : ''}
                    `;
                    grid.appendChild(imgElement);
                });
            }

            renderLinks() {
                const list = document.getElementById('linksList');
                list.innerHTML = '';
                
                this.currentData.links.forEach(link => {
                    const linkElement = document.createElement('div');
                    linkElement.className = 'link-item';
                    linkElement.innerHTML = `
                        <strong>–¢–µ–∫—Å—Ç:</strong> ${link.text}<br>
                        <strong>URL:</strong> <a href="${link.url}" target="_blank">${link.url}</a>
                        ${link.title ? `<br><strong>Title:</strong> ${link.title}` : ''}
                    `;
                    list.appendChild(linkElement);
                });
            }

            renderStats() {
                const stats = this.currentData.stats;
                const grid = document.getElementById('statsGrid');
                
                grid.innerHTML = `
                    <div class="stat-card">
                        <div class="stat-value">${stats.words}</div>
                        <div>–°–ª–æ–≤</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${stats.characters}</div>
                        <div>–°–∏–º–≤–æ–ª–æ–≤</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${stats.readingTime}</div>
                        <div>–ú–∏–Ω—É—Ç —á—Ç–µ–Ω–∏—è</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${stats.images}</div>
                        <div>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${stats.links}</div>
                        <div>–°—Å—ã–ª–æ–∫</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${stats.paragraphs}</div>
                        <div>–ü–∞—Ä–∞–≥—Ä–∞—Ñ–æ–≤</div>
                    </div>
                `;
            }

            searchContent(query) {
                const content = document.getElementById('contentArea').textContent;
                if (!query.trim()) {
                    document.getElementById('contentArea').textContent = this.currentData.mainContent;
                    return;
                }

                const regex = new RegExp(query, 'gi');
                const highlighted = this.currentData.mainContent.replace(regex, 
                    match => `[[HIGHLIGHT]]${match}[[/HIGHLIGHT]]`
                );
                
                document.getElementById('contentArea').innerHTML = highlighted
                    .split('[[HIGHLIGHT]]')
                    .map(part => {
                        if (part.includes('[[/HIGHLIGHT]]')) {
                            const [highlightedPart, rest] = part.split('[[/HIGHLIGHT]]');
                            return `<mark>${highlightedPart}</mark>${rest}`;
                        }
                        return part;
                    })
                    .join('');
            }

            copyContent() {
                const activeTab = document.querySelector('.tab.active').dataset.tab;
                let content = '';
                
                switch (activeTab) {
                    case 'content':
                        content = document.getElementById('contentArea').textContent;
                        break;
                    case 'metadata':
                        content = document.getElementById('metadataArea').textContent;
                        break;
                    case 'stats':
                        content = JSON.stringify(this.currentData.stats, null, 2);
                        break;
                }
                
                navigator.clipboard.writeText(content).then(() => {
                    this.showNotification('–°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞');
                });
            }

            exportContent() {
                if (!this.currentData) return;
                
                const format = prompt('–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ—Ä–º–∞—Ç —ç–∫—Å–ø–æ—Ä—Ç–∞ (txt, json, html):', 'txt');
                let content, mimeType, extension;
                
                switch (format) {
                    case 'json':
                        content = JSON.stringify(this.currentData, null, 2);
                        mimeType = 'application/json';
                        extension = 'json';
                        break;
                    case 'html':
                        content = this.generateHtmlExport();
                        mimeType = 'text/html';
                        extension = 'html';
                        break;
                    default:
                        content = this.generateTextExport();
                        mimeType = 'text/plain';
                        extension = 'txt';
                }
                
                const blob = new Blob([content], { type: mimeType });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `web-content-${new Date().getTime()}.${extension}`;
                a.click();
                URL.revokeObjectURL(url);
            }

            generateTextExport() {
                return `
–≠–∫—Å–ø–æ—Ä—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü—ã
URL: ${this.currentData.url}
–î–∞—Ç–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è: ${new Date(this.currentData.timestamp).toLocaleString()}

–û–°–ù–û–í–ù–û–ô –¢–ï–ö–°–¢:
${this.currentData.mainContent}

–°–¢–ê–¢–ò–°–¢–ò–ö–ê:
- –°–ª–æ–≤: ${this.currentData.stats.words}
- –°–∏–º–≤–æ–ª–æ–≤: ${this.currentData.stats.characters}
- –í—Ä–µ–º—è —á—Ç–µ–Ω–∏—è: ${this.currentData.stats.readingTime} –º–∏–Ω.
- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: ${this.currentData.stats.images}
- –°—Å—ã–ª–æ–∫: ${this.currentData.stats.links}
                `.trim();
            }

            generateHtmlExport() {
                return `
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>–≠–∫—Å–ø–æ—Ä—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ - ${this.currentData.url}</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .section { margin-bottom: 30px; }
        .stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
        .stat-item { background: #f5f5f5; padding: 10px; border-radius: 5px; }
    </style>
</head>
<body>
    <h1>–≠–∫—Å–ø–æ—Ä—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü—ã</h1>
    <div class="section">
        <h2>–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h2>
        <p><strong>URL:</strong> ${this.currentData.url}</p>
        <p><strong>–î–∞—Ç–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è:</strong> ${new Date(this.currentData.timestamp).toLocaleString()}</p>
    </div>
    <div class="section">
        <h2>–û—Å–Ω–æ–≤–Ω–æ–π —Ç–µ–∫—Å—Ç</h2>
        <pre>${this.currentData.mainContent}</pre>
    </div>
    <div class="section">
        <h2>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
        <div class="stats">
            <div class="stat-item">–°–ª–æ–≤: ${this.currentData.stats.words}</div>
            <div class="stat-item">–°–∏–º–≤–æ–ª–æ–≤: ${this.currentData.stats.characters}</div>
            <div class="stat-item">–í—Ä–µ–º—è —á—Ç–µ–Ω–∏—è: ${this.currentData.stats.readingTime} –º–∏–Ω.</div>
            <div class="stat-item">–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: ${this.currentData.stats.images}</div>
            <div class="stat-item">–°—Å—ã–ª–æ–∫: ${this.currentData.stats.links}</div>
        </div>
    </div>
</body>
</html>
                `.trim();
            }

            addToHistory(url) {
                const existingIndex = this.history.findIndex(item => item.url === url);
                if (existingIndex !== -1) {
                    this.history.splice(existingIndex, 1);
                }
                
                this.history.unshift({
                    url,
                    timestamp: new Date().toISOString()
                });
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 50 –∑–∞–ø—Ä–æ—Å–æ–≤
                this.history = this.history.slice(0, 50);
                localStorage.setItem('extractionHistory', JSON.stringify(this.history));
                this.renderHistory();
            }

            renderHistory() {
                const list = document.getElementById('historyList');
                list.innerHTML = '';
                
                this.history.forEach(item => {
                    const historyItem = document.createElement('div');
                    historyItem.className = 'history-item';
                    historyItem.innerHTML = `
                        <strong>${item.url}</strong>
                        <br><small>${new Date(item.timestamp).toLocaleString()}</small>
                    `;
                    historyItem.addEventListener('click', () => {
                        document.getElementById('urlInput').value = item.url;
                        this.extractContent();
                    });
                    list.appendChild(historyItem);
                });
            }

            switchTab(tabName) {
                // –î–µ–∞–∫—Ç–∏–≤–∏—Ä—É–µ–º –≤—Å–µ —Ç–∞–±—ã
                document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
                
                // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ç–∞–±
                document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
                document.getElementById(`${tabName}Tab`).classList.add('active');
            }

            showLoading(show) {
                document.getElementById('loading').style.display = show ? 'block' : 'none';
                document.getElementById('extractBtn').disabled = show;
            }

            showNotification(message, type = 'success') {
                const notification = document.getElementById('notification');
                notification.textContent = message;
                notification.className = `notification ${type} show`;
                
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 3000);
            }

            isValidUrl(string) {
                try {
                    new URL(string);
                    return true;
                } catch (_) {
                    return false;
                }
            }

            toggleTheme() {
                document.body.classList.toggle('light-mode');
                const isLight = document.body.classList.contains('light-mode');
                localStorage.setItem('theme', isLight ? 'light' : 'dark');
                document.getElementById('themeToggle').textContent = isLight ? 'üåû' : 'üåô';
            }

            loadTheme() {
                const savedTheme = localStorage.getItem('theme') || 'dark';
                if (savedTheme === 'light') {
                    document.body.classList.add('light-mode');
                    document.getElementById('themeToggle').textContent = 'üåû';
                }
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        document.addEventListener('DOMContentLoaded', () => {
            new WebContentExtractor();
        });
    </script>
</body>
</html>
